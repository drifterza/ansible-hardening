---
###########################################
############## USERS ######################
###########################################

env: prod
datacenter: uk
user_management:
  - name: donovan
    shell: /bin/bash
    groups:
      - sudo
    ssh_keys:
      - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDVYZCD5TQaG40GcsS6ysKhqlS5aX3YrO29c/t3MdDYA82gqex6CQvxkvhKsY8JzMB3EFfUBhcp85U68phDCigizxv1DD0UVrLEyAORqI/uktQMj14peeNmHaHdCy2BgHCr3ywh9IewzYO9YAwZ3yrL0Ubi14CG73h4SBlhnSx4M3L/HHvUcvXno7aFjdYl5Ma4ZW+LOScZ1ZAFC8Aa3vsIbkmbPHzfHeoVuVv2+eRGfPUThbuXu1U8eKiGwxuAH1Ybfx2u8pUSFdhLtOQxz4IeSX+tA06lhxn1bBL/OjMyEXvIJecJOqRIBJEKCRdmZsJeiRFnid06GMLteXcyZu1 donovan@donovan-HP-ProBook-650-G1"
  - name: root
    shell: /bin/bash
    groups:
      - sudo
    ssh_keys:
    - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDXZrPFiRXAZc8GxQnCDK25yy9iV0/JF9mlStJRPO6xKEbR5lQClIPDtixZv19YdvVA9v9DvTnd6REQF6bqBjjGGkEbNWKTEyE4nO6Pq8czG6/lspGPbwwVz3ggFx+inoBTmsAkrZuISImrAydUNbfuUEaL4L40miCOax+XkDFl5vfytkZNmBImqqvrVLdtwkgbmQSOwrYGS6jxFGNY2hgyxn2fGtXrbjRGD+m9ISV6vOSbyyGsXkbPZWIEHrUNZcRDt3zN9E25wk6+7iket+C2W1dKMI9CDb5jXVdYcY0FD7pHZMxLtgy3qevMan1TT18NFivZvAZwH42vBwASDJDX root@admin"
  - name: andrew
    shell: /bin/bash
    groups:
     - sudo
    ssh_keys:
    - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDXj8GAPEp8Iod7C3UFBGiczT9YmEiYFDVXtPfQzUT3s90Db0/srALzqlnkMR65cC/PCqbwj54d5Ly05chEThj3njYiDzen5XmZHZ93YPHfN9XEeTlkCkErAGnc0uImctMN5Zih2RX1BahoZdIyBBjnxDAr36HEJl1vwnF6yvQrzd4IF73XwcWKeSTofgYWdwEuDWdeGWY3w+97LjwMndV0RmaqWAWSELoEvnSST/twHiO5FF8LkEdeyib07DeMva7tNqmfsYi4pJpjexVghb14tsP5dYGuX2Q2umvd9K7T7sIGwdo2xb3SNXQXixiVmWEbTRK5uuc6Otn7QsvwGLEK6bSmACTbBoKy1g7TIEfY+rzsc0sEjhdoNvf8rYLqHSuANJiRhTgX8wePwPiLCMWDFcNQ3vrUCd3fp+Wb3xfXknQo2quiV3w50Ht1/jyrhvl/Scmbyvu5FIG4ixC7KVYgD57PMDWwmakEPdcFe5U92zYDIYFHbawZjODkZp//dVPHG3DlJDQkr1um877VjUlKCvbSDz/M6SKAmhmw3Q5nIXZeG0c2CP5WO13fgxMTi6kXtZuo0Io8dzN7rXDzCG8RuDxmtHjE8B1EQ/8c8eXeBLg20CKuRcvo2noEV4ejKB2udb9xuI3Akd/3uGcnrvVaJV9xQI9Va5Jsi7GPsNGi9w== Andrew@AndrewKlopper"
  - name: kaveer
    shell: /bin/bash
    groups:
      - sudo
    ssh_keys:
    - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDaeVVaRg2xO2kggz/V1q85LZriPnqwpgAiQ0fKcObF3EoRAun/RWGsVOpM4vsYJxswph72gvbYBm3t00myLY5kbSnoLIYQoQVT2QN+FphZjprHIJ/OdGLcXFiIqIOhCnDHv7R0vG7YokzLD645OTNwcm8o3cAto4gIhzdD/PXQBcZu7p6J0V6aT8W2mWOwG6TmO9vLwy+cwxYqJWdVqo7FFoqBmormk0eP1WW0vcCxkoDhJTkjeQ3qzVae04ByNvEALAG2lVk+ohu6SS6hBRlJHbAiwDKxiVJQYOLBk5o7YRuJSaoHuZct9OlALiJRuUI9lHkw+YyH76r0pHaiLu0h kaveerh@kaveers-MacBook-Pro.local"
  - name: neven
    shell: /bin/bash
    groups:
      - sudo
    ssh_keys:
      - "ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAgEA2+jPMCm3kICQo8GYApy8WtmU72WggCM8oW0cpYVGwT05Z9REwIS+Fz6iYsX4SaVgIoMWV7hnx6VcUgsTUzuOuKGuvBhDgaSAMWj9Xrjj9kS0Yscx/b7THGV+anFy+39/5sZzX51q0Oc3zmdd+hzW3/EMZ+aWANRuFhi/WAYwAVT39hnTAO6BIuhAbnwE0YsvE/F5aoo/TD2xe7uP0E88WPpQMnMmwYVmtorhhh7+4bSFQjenmHSQJjYGiCxYmEf8DpS9iqvw34AUpOzY1PIZVuk4uGI45K3FLlfsAYnIlo/8o2un8kFj/aJ63/fkqx24tDDDy7xAKJ0zGIU3Oie45Yx6J3Fl6TehpYxu8tMfB4p0U6LOSf8WTf4YzaEMrsMd7UP/UJ/A7OoyQ9o6AyWHZZ5NEQvxtY8Q/0Ln8JFSXBl7/Hv9ID9gOJJj/rK4F53IYNDUWV3PSOScppVKctifFB26jHboEm0dUpjeuVQ9Uuxe1E9YIveKUiGYH3ju9uoq3QoclQPelRQ0fJOf+SrLRtjWv3p//YWRE7gPkl3YX/bJJgIujxrQ55bXvkgkUQf6B6jnlazhVPw113onJywdvI235BN9TJo9s5AsXlFYOeHs+Y+QuoJIABRfvjl5bBez52zf/kQVlhim6at+ILW+Gk/SskdW2ERN1oytSI7BvTk= nevenm@fanmode.com"

###########################################
############## Security ###################
###########################################

ssh_permit_root_login: "no"
ssh_remove_deprecated_server_keys: true
security_autoupdate_reboot_time: "03:00"
security_autoupdate_reboot: true
security_autoupdate_mail_to: "donovanf@fanmode.com"
security_autoupdate_mail_on_error: true
security_fail2ban_enabled: true
ssh_port: 123
security_ssh_port: 123
security_sudoers_passwordless:
  - donovan
  - andrew
  - kaveer
  - neven

###########################################
############## Apache #####################
###########################################

apache_create_vhosts: true
apache_mods_enabled:
  - rewrite.load
  - ssl.load
  - proxy.load
  - proxy_http.load
  - proxy_html.load
  - lbmethod_byrequests.load
  - headers.load
apache_remove_default_vhost: true
apache_vhosts:
  - servername: "registry.fanmode.com"
    extra_parameters:
      Redirect permanent / https://registry.fanmode.com/
apache_vhosts_ssl:
  - servername: "registry.fanmode.com"
    certificate_file: "/etc/letsencrypt/live/registry.fanmode.com/cert.pem"
    certificate_key_file: "/etc/letsencrypt/live/registry.fanmode.com/privkey.pem"
    certificate_chain_file: "/etc/letsencrypt/live/registry.fanmode.com/chain.pem"
    extra_parameters_nodecode: 'AllowEncodedSlashes NoDecode'
    extra_parameters: 'ProxyPass /  http://127.0.0.1:8081/ nocanon'
    extra_parameters_reverse: 'ProxyPassReverse /  http://127.0.0.1:8081/'
    extra_parameters_requestheader: 'RequestHeader set X-Forwarded-Proto "https"'

###########################################
############## Certbot ####################
###########################################

certbot_create_if_missing: true
certbot_admin_email: "donovanf@fanmode.com"
certbot_auto_renew_user: "donovan"
certbot_auto_renew_minute: "20"
certbot_auto_renew_hour: "5"
certbot_certs:
  - email: "donovanf@fanmode.com"
    domains:
      - registry.fanmode.com
certbot_create_standalone_stop_services:
  - apache2

###########################################
############## Nexus ######################
###########################################

nexus_delete_default_repos: true
nexus_delete_default_blobstore: true
nexus_anonymous_access: false
nexus_audit_enabled: true
nexus_timezone: "UTC"
nexus_download_dir: "/var/tmp"
nexus_data_dir: "/data/nexus"
nexus_min_heap_size: "1200M"
nexus_max_heap_size: "{{ nexus_min_heap_size }}"
nexus_max_direct_memory: "6G"
nexus_public_hostname: "registry.fanmode.com"
nexus_public_scheme: https
nexus_api_scheme: http
nexus_docker_hosted_port: 5000
nexus_docker_proxy_port: 5001
nexus_docker_group_port: 5002
nexus_backup_configure: true
nexus_backup_cron: "0 0 21 * * ?"
nexus_backup_dir: "/backup/nexus"
nexus_restore_log: "{{ nexus_backup_dir }}/nexus-restore.log"
nexus_backup_rotate: true
nexus_backup_rotate_first: false
nexus_email_server_enabled: false
httpd_default_admin_email: "admin@fanmode.com"
httpd_setup_enable: false
httpd_ssl_cert_file: "/etc/letsencrypt/live/registry.fanmode.com/cert.pem"
httpd_ssl_cert_key: "/etc/letsencrypt/live/registry.fanmode.com/privkey.pem"
httpd_ssl_cert_chain_file: "/etc/letsencrypt/live/registry.fanmode.com/chain.pem"
httpd_copy_ssl_files: false
nexus_backup_keep_rotations: 4
#nexus_scheduled_tasks:
#  - name: compact-docker-blobstore
#    cron: '0 0 22 * * ?'
#    typeId: blobstore.compact
#    task_alert_email: donovanf@fanmode.com
#    taskProperties:
#      blobstoreName: "{{ nexus_blob_names.docker.blob }}"
#  - name: Purge-maven-snapshots
#    cron: '0 50 23 * * ?'
#    typeId: repository.maven.remove-snapshots
#    task_alert_email: donovanf@fanmode.com
#    taskProperties:
#      repositoryName: "*"
#      minimumRetained: "2"
#      snapshotRetentionDays: "2"
#      gracePeriodInDays: "2"
#    booleanTaskProperties:
#      removeIfReleased: true
#  - name: Purge unused docker manifests and images
#    cron: '0 55 23 * * ?'
#    typeId: "repository.docker.gc"
#    task_alert_email: donovanf@fanmode.com
#    taskProperties:
#      repositoryName: "*"
     